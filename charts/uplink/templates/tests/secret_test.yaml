suite: test secret.yaml
templates:
  - secret.yaml
tests:
  - it: should ensure the secret has correct metadata
    set:
      postgresql.url: "example-url"
      client.id: "example-id"
      client.secret: "example-secret"
      sentry.dsn: "example-dsn"
    asserts:
      - isKind:
          of: Secret
      - equal:
          path: metadata.name
          value: "RELEASE-NAME-uplink."
      - hasDocuments:
          count: 1

  - it: should check data fields in secret
    set:
      postgresql.url: "example-url"
      client.id: "example-id"
      client.secret: "example-secret"
      sentry.dsn: "example-dsn"
    asserts:
      - equal:
          path: data.postgresql.url
          value: "example-url"
      - equal:
          path: data.client.id
          value: "ZXhhbXBsZS1pZA==" # Base64 encoded value of "example-id"
      - equal:
          path: data.client.secret
          value: "ZXhhbXBsZS1zZWNyZXQ=" # Base64 encoded value of "example-secret"
      - equal:
          path: data.sentry.dsn
          value: "ZXhhbXBsZS1kc24=" # Base64 encoded value of "example-dsn"

  # Add more tests as required...
